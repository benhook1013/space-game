# 🚀 Space Miner Game Dev Plan (Mobile, Codex-Based, PWA with Host-Based Multiplayer)

This is a mobile-first, Codex-driven game development workflow for a 2D space shooter built using Flutter and Flame. It includes **Progressive Web App (PWA)** support for offline install on iOS, and is future-proofed for **host-authoritative multiplayer co-op** without requiring a central game server.

---

## ✅ Master Checklist

### ⚙️ 1. Project Setup

- [ ] Create GitHub repository (`space-miner` or similar)
  - Public (to use GitHub CI for free)
  - Add `README.md`
  - Add `.gitignore` for Flutter: https://github.com/github/gitignore/blob/main/Dart.gitignore
  - Use FVM with `fvm_config.json` to pin the Flutter SDK version
- [ ] Connect Codex to the repo (or copy-paste code via GitHub Mobile / Codespaces)
- [ ] Optional: Use GitHub Mobile + Replit or Termux for light editing
- [ ] Add `LICENSE` file (MIT)

---
### 🔢 2. Tooling & Versions

- Pin the Flame version in `pubspec.yaml`, just like Flutter (for stability and Codex compatibility).

---


### 🧠 3. Design Documents

- [ ] `DESIGN.md`
  - Prompt Codex:
    > Write a design document for a 2D space shooter mobile game using Flutter and Flame. The game includes spaceship movement, shooting enemies, mining asteroids, upgrading weapons, and future multiplayer co-op using host-based authority.
- [ ] `TASKS.md`
  - Prompt Codex:
    > Based on the design doc, generate a prioritized list of technical tasks to implement the game, including future-proofing for multiplayer support.
- [ ] Optional: Break into milestones:
  - `milestone-1.md`: movement + shooting  
  - `milestone-2.md`: enemies + collision  
  - `milestone-3.md`: mining + upgrades  
  - `milestone-4.md`: local save + networking scaffold

### 🎮 4. Game Design

A fun, light-hearted space shooter with cute cartoony style. Casual tone, accessible on both desktop and mobile via PWA.

---

### 🧪 5. Basic Project Scaffolding

- [ ] Prompt Codex:
  > Create a basic Flutter project with Flame integrated for a 2D game.
- [ ] Files to generate:
  - `main.dart`
  - `game.dart` (extends `FlameGame`)
  - `player.dart`, `enemy.dart`, `bullet.dart`, `asteroid.dart`
- [ ] Prompt Codex:
  > Create a player spaceship component in Flame that can rotate and move using virtual joystick or touch input.
- [ ] Future-proof for multiplayer:
  - [ ] Use entity UUIDs for all game objects
  - [ ] Store world state in a serializable format (JSON)
  - [ ] Create an `Action` model (e.g. move, shoot, mine) to allow input-based syncing
  - [ ] Modularize tick/update logic into a host-simulatable loop

---

### 🎨 6. Asset Setup

- [ ] Create core asset folders:
  - `assets/images`
  - `assets/audio`
  - `assets/fonts`
- [ ] Add placeholder assets if needed for Codex development
- [ ] `ASSET_GUIDE.md` documenting folder layout, common asset sources and attribution requirements
- [ ] `ASSET_CREDITS.md` to track third-party asset usage and licensing

---

### 🌐 7. PWA Support (for iOS Install + Offline Mode)

- [ ] Ensure Flutter project is web-enabled (`flutter config --enable-web`)
- [ ] Prompt Codex:
  > Add PWA support to a Flutter web app, including manifest and service worker for offline use.
- [ ] Create or customize:
  - `web/manifest.json`
  - `web/icons/` (192x192, 512x512 icons)
  - `web/flutter_service_worker.js` (auto-generated by `flutter build web`)
- Lock screen orientation to landscape (better gameplay and consistent UI).
- Add `manifest.json` fields:
  - "start_url": "/"
  - "display": "standalone"
  - "background_color": "#000000"
  - "theme_color": "#0f0f0f"
- Use the default `flutter_service_worker.js` for offline caching (no customization planned for now).

- [ ] Test PWA:
  - Build: `flutter build web`
  - Host locally: `flutter run -d web-server`
  - Test on iPhone: Visit IP in Safari and tap **“Add to Home Screen”**

---

### 🚀 8. Web Hosting

- [ ] Deploy PWA build for public access:
  - [ ] GitHub Pages (easiest for public repos)
  - [ ] OR Netlify (drag-and-drop / CI-based)
  - [ ] OR Firebase Hosting (great offline support)
- [ ] Prompt Codex:
  > Create a GitHub Actions workflow that deploys Flutter web build to GitHub Pages on every push.

---
### 🚀 9. Releases

- Target PWA/Web-first release so players can play on desktop or mobile instantly.
- No native app stores (Play Store/TestFlight) planned for now.
- Prioritize hosting help (e.g., GitHub Pages or Netlify) over app publishing.

---


### 🔁 10. CI/CD Integration (Optional Native Builds)

- [ ] Set up [Codemagic](https://codemagic.io/) for iOS/Android APKs
  - Link GitHub repo
  - Choose Flutter template
- [ ] Prompt Codex:
  > Create a `codemagic.yaml` to build Flutter game and export Android APK.
- [ ] Optional GitHub Actions:
  - `.github/workflows/build.yaml`
  - Prompt Codex:
    > Create GitHub Action to build Flutter game on push.

---
### 📊 11. Analytics & DevOps

- No crash reporting or analytics planned.
- Codex: skip all Sentry/Firebase/metrics suggestions.

---


### 🧪 12. Code Formatting & Linting (Codex-Compatible)

- Use Flutter defaults:
  - `dart format`
  - `flutter analyze`
- Include default `.analysis_options.yaml` with no extra rules
- Avoid additional lint tools or pre-commit hooks
- GitHub Actions workflow should:
  - Run `flutter analyze` and `dart format` on PRs
  - Auto-run `dart format .` and commit the results
- Enforce PR merge checks via GitHub settings

---

### 🧩 13. Multiplayer Plan (Future Feature)

Design for **host-authoritative co-op multiplayer**:

- [ ] Add `networking.md` to outline:
  - Co-op PvE model with host device simulating world state
  - Other players connect via WebSocket
  - Skip WebRTC or NAT traversal — assume same-network play or QR-based join flow.
  - Plan for a basic JSON-based action protocol (e.g., move, shoot, mine)
  - Examples of message types will be documented in `multiplayer_protocol.md`.
  - [ ] `WorldState` model: serializable snapshot of game state
  - [ ] `GameAction` enum + action handler logic
  - [ ] Basic WebSocket scaffold in place (even if unused)
- [ ] Optional: Use Firebase for lobby/discovery only
- [ ] Prompt Codex:
  > Create a Flutter WebSocket-based game host that simulates a tick loop and accepts remote player input actions.

---

### 🗄️ 14. Backend Plan (Optional)

Choose one:

- [ ] Offline-only: use local storage or SQLite
- [ ] Online progression: Firebase (Firestore or Realtime DB)
  - Prompt Codex:
    > Generate code for syncing inventory/upgrades to Firebase Firestore.
- [ ] Custom backend (if needed later): Fly.io or Railway

---

### 🛠 15. Game Features – Dev Plan

Break into Codex prompts and commits:

- [ ] Ship movement with rotation + thrust
- [ ] Touch or joystick controls
- [ ] Shooting + bullet collisions
- [ ] Spawn enemies randomly
- [ ] Asteroids to mine
- [ ] Inventory system (local or remote)
- [ ] Weapon upgrade system
- [ ] HUD for health, ammo, score
- [ ] Shop or upgrade UI
- [ ] Sound and music
- [ ] Save/load game state
- [ ] Main menu + pause/resume
- [ ] Multiplayer-ready:
  - [ ] Entity UUIDs
  - [ ] Syncable game state
  - [ ] Serializable actions

---

### 📦 16. Native Deployment (Optional)

- Not planned for now; focus on PWA release.
- [ ] Prompt Codex:
  > Write instructions to publish Flutter game to Google Play and TestFlight using Codemagic.
- [ ] Set up:
  - Google Play Developer ($25 one-time)
  - Apple Developer ($99/year)
  - Signing keys for Codemagic or Fastlane

---

### 🧪 17. Testing & QA (Manual-Only, Branch-Based)

- Manual testing only (no automated tests yet)
- `develop` branch deploys to staging
- `main` branch deploys to production
- Use `PLAYTEST_CHECKLIST.md` for each play session
- Optional `playtest_logs/` to track regressions
- GitHub Actions or hosting config should:
  - Auto-deploy `develop` to a test/staging URL
  - Auto-deploy `main` to production

---

### 📚 18. Documentation

- [ ] `README.md`
  - Prompt Codex:
    > Document the codebase with setup, build, PWA install, and multiplayer design notes.
- [ ] Inline Dart docstrings and code comments
- [ ] Keep `DESIGN.md` and `networking.md` updated

---

### 📌 19. Project Management

- No milestone tracking or GitHub Projects planned.
- Codex: avoid suggesting complex project planning tools.

---

## 🔄 Daily Loop

```text
1. Use Codex to write code or generate files
2. Push to GitHub (via app or web)
3. GitHub CI or Codemagic builds PWA and/or APK
4. Access public PWA URL and test on iPhone
5. Install via "Add to Home Screen" for offline play
6. Continue development from TASKS.md
```
